<div class='container-fluid plant'>
    <div id="actionDanger" style="margin-top:5px;" class="alert alert-danger">
        {{ErrorMessage}}
    </div>
    <div class='row'>
        <div class='col-lg-5 col-md-6 col-sm-12'>
            <div class='row map-container'>
                <div class='col-xs-12'>
                    <div class='panel panel-default tools-panel'>
                        <div class='panel-heading'>
                            <ul class="nav nav-pills nav-justified">
                                <li class="active"  id="tool"><a href="" ng-click="showTools()" data-toggle="tab">Tools</a></li>
                                <li id="alarm"><a href data-toggle="tab" ng-click="showAlarms()">Alarms</a></li>
                            </ul>
                        </div>
                        <div class='panel-body' style="overflow-x: auto; overflow-y: auto">
                            <div id="toolsTab" ng-show="isTools">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Filter.." ng-model="query" id="filterData">
                                    <div class="input-group-addon" ng-click="clearFilter()" id="clearData"><span id="clearDataId" class="glyphicon glyphicon-remove" style="cursor: pointer" ng-click="clearFilter()"></span></div>
                                </div>
                                <div class="customTable">
                                    <table class="table" id="toolsTable">
                                        <thead class="active">
                                        <tr>
                                            <th id="toolIdHeader">
                                                <a href="" ng-click="orderByField=sorterFunc; reverseSort = !reverseSort">
                                                    Tool ID <span ng-show="orderByField == sorterFunc"><span ng-show="!reverseSort">^</span><span ng-show="reverseSort">v</span></span>
                                                </a>
                                            </th>
                                            <th id="toolStateHeader">
                                                <a href="" ng-click="orderByField=customOrder; reverseSort = !reverseSort">
                                                    Tool State <span ng-show="orderByField == customOrder"><span ng-show="!reverseSort">^</span><span ng-show="reverseSort">v</span></span>
                                                </a>
                                            </th>
                                            <th id="alarmNumberHeader">
                                                <a href="" ng-click="orderByField='alarms[0].alarmNumber'; reverseSort = !reverseSort">
                                                    Alarm # <span ng-show="orderByField == 'alarms[0].alarmNumber'"><span ng-show="!reverseSort">^</span><span ng-show="reverseSort">v</span></span>
                                                </a>
                                            </th>
                                            <th id="alarmTextHeader">
                                                <a href="" ng-click="orderByField='alarms[0].message'; reverseSort = !reverseSort">
                                                    Alarm Text <span ng-show="orderByField == 'alarms[0].message'"><span ng-show="!reverseSort">^</span><span ng-show="reverseSort">v</span></span>
                                                </a>
                                            </th>
                                            <th id="cycleCountHeader">
                                                <a href="" ng-click="orderByField='cycleCount'; reverseSort = !reverseSort">
                                                    Cycle Count <span ng-show="orderByField == 'cycleCount'"><span ng-show="!reverseSort">^</span><span ng-show="reverseSort">v</span></span>
                                                </a>
                                            </th>
                                            <th id="alarmTypeHeader">
                                                <a href="">
                                                    Alarm Type
                                                </a>
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <div>
                                            <tr ng-repeat="tool in tools |filter:search | orderBy:orderByField:reverseSort"  ng-dblclick="toolInformation($event, tool)"
                                                ng-class="{'selected':tool.assetId == selectedRow}"  id="row{{tool.assetId}}" ng-mouseover="showRowTitle($event, tool)" ng-click="showToolMap($event,tool.assetId)" style="cursor: pointer; height: 46px;">
                                                <td><a href="" ui-sref="app.tooldetails({ toolID:tool.assetId })" style="text-decoration: underline">{{tool.assetId}}</a></td>
                                                <td><span><i id="col{{tool.assetId}}"></i>{{tool.toolState}}</span></td>
                                                <td  ng-if="tool.alarms.length>0 && tool.alarms[0].severity != 'INFO'">
                                                    {{tool.alarms[0].alarmNumber}}
                                                </td>
                                                <td ng-if="tool.alarms[0].severity == 'INFO'"></td>
                                                <td ng-if="tool.alarms== null || tool.alarms.length === 0"></td>
                                                <td ng-if="tool.alarms.length>0 && tool.alarms[0].severity != 'INFO'">
                                                    {{tool.alarms[0].message}}
                                                </td>
                                                <td ng-if="tool.alarms[0].severity == 'INFO'"></td>
                                                <td ng-if="tool.alarms== null || tool.alarms.length === 0"></td>
                                                <td><span>{{tool.cycleCount}}</span></td>
                                                <td ng-if="getAlarmStatus(tool)" style="text-align: center"><i id="status{{tool.assetId}}"></i></td>
                                                <td ng-if="!getAlarmStatus(tool)"></td>
                                            </tr>
                                        </div>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div id="alarmsTab" ng-hide="isTools">
                                <div ng-show="isSummary" id="summaryDiv">
                                    <div class='col-xs-12' id="criticalAlarmsDiv">
                                        <div class='panel panel-default availability-panel'>
                                            <div class='panel-body criticalAlarm' style="cursor: pointer" id="alarmsSummaryDiv" ng-click="alarmsSummary('CRITICAL',totalCriticalCount)">
                                                <div class='col-xs-6'>
                                                    <div  class='alarm-tile text-danger' id="criticalAlarms" >
                                                        <div  class='icon'>
                                                            <i class='fa fa-times-circle fa-3x'></i>
                                                            <span class='fa-3x'>{{totalCriticalCount}}</span>
                                                            <div>CRITICAL</div>
                                                        </div>
                                                        <div>
                                                            Current #: {{criticalCount}}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class='col-xs-6'>
                                                    <div class='icon' style="margin-top: 5%">
                                                        <i class='fa fa-chevron-right fa-3x pull-right'></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='col-xs-12' id="warningAlarmsDiv">
                                        <div class='panel panel-default availability-panel'>
                                            <div class='panel-body warningAlarm' style="cursor: pointer" id="warningAlarmsSummaryDiv" ng-click="alarmsSummary('WARNING', totalWarningCount )">
                                                <div class='col-xs-6'>
                                                    <div  class='alarm-tile text-warning' id="warningAlarms" >
                                                        <div class='icon'>
                                                            <i class='fa fa-exclamation-triangle fa-3x'></i> <span class='fa-3x'>{{totalWarningCount}}</span>
                                                            <div>WARNING</div>
                                                        </div>
                                                        <div>
                                                            Current #: {{warningCount}}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class='col-xs-6'>
                                                    <div class='icon' style="margin-top: 5%">
                                                        <i class='fa fa-chevron-right fa-3x pull-right'></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='col-xs-12' id="infoAlarmsDiv">
                                        <div class='panel panel-default availability-panel'>
                                            <div class='panel-body infoAlarm' style="cursor: pointer" id="infoAlarmsSummaryDiv" ng-click="alarmsSummary('INFO', totalInfoCount)">
                                                <div class='col-xs-6'>
                                                    <div  class='alarm-tile text-success' id="infoAlarms" >
                                                        <div class='icon'>
                                                            <i class='fa fa-info-circle fa-3x'></i> <span class='fa-3x'>{{totalInfoCount}}</span>
                                                            <div>INFO</div>
                                                        </div>
                                                        <div>
                                                            Current #: {{infoCount}}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class='col-xs-6'>
                                                    <div class='icon' style="margin-top: 5%">
                                                        <i class='fa fa-chevron-right fa-3x pull-right'></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='col-xs-12' id="maintenanceAlarmsDiv">
                                        <div class='panel panel-default availability-panel'>
                                            <div class='panel-body warningAlarm' style="cursor: pointer" id="maintenanceAlarmsSummaryDiv" ng-click="alarmsSummary('MAINTENANCE', totalMaintCount)">
                                                <div class='col-xs-6'>
                                                    <div  class='alarm-tile text-info' id="maintenanceAlarms" >
                                                        <div class='icon'>
                                                            <i class='fa fa-clock-o fa-3x'></i> <span class='fa-3x'>{{totalMaintCount}}</span>
                                                            <div>MAINTENANCE</div>
                                                        </div>
                                                        <div>
                                                            Current #: {{maintCount}}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class='col-xs-6'>
                                                    <div class='icon' style="margin-top: 5%">
                                                        <i class='fa fa-chevron-right fa-3x pull-right'></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div ng-show="isDetail" id="alarmDetailsDiv" style="overflow-x: auto; overflow-y: auto">
                                    <div class='col-xs-12' id="criticalAlarmsTable">
                                        <div class='panel-heading' id="alarmsCountId">
                                            <strong ng-if="numberOfAlarms < 500" id="alarmsTypeId">{{alarmType}} Alarms</strong>
                                            <strong ng-if="numberOfAlarms > 500" id="alarmsCountTypeId">Top 500 {{alarmType}} Alarms</strong>
                                            <span class="fa fa-times fa-1x pull-right" id="closeAlarmDetailsId" style="cursor: pointer" ng-click="closeTable()"></span>
                                        </div>
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="Filter.." ng-model="queryAlarm" id="filterAlarmData">
                                            <div class="input-group-addon" ng-click="clearAlarmFilter()" id="clearAlarmData"><span class="glyphicon glyphicon-remove" style="cursor: pointer" ng-click="clearAlarmFilter()"></span></div>
                                        </div>
                                        <div class="customTable" style="overflow-x: auto; overflow-y: auto">
                                            <table class="table" id="alarmsInfoId">
                                                <thead class="active">
                                                <tr>
                                                    <th id="timeAlarmsHeader">
                                                        <a href="" ng-click="orderByAlarmField='timestamp'; reverseAlarmSort = !reverseAlarmSort">
                                                            Time <span ng-show="orderByAlarmField == 'timestamp'"><span ng-show="!reverseAlarmSort">^</span><span ng-show="reverseAlarmSort">v</span></span>
                                                        </a>
                                                    </th>
                                                    <th id="messageAlarmsHeader">
                                                        <a href="" ng-click="orderByAlarmField='message'; reverseAlarmSort = !reverseAlarmSort">
                                                            Message <span ng-show="orderByAlarmField == 'message'"><span ng-show="!reverseAlarmSort">^</span><span ng-show="reverseAlarmSort">v</span></span>
                                                        </a>
                                                    </th>
                                                    <th id="alarmNumHeader">
                                                        <a href="" ng-click="orderByAlarmField='alarmNumber'; reverseAlarmSort = !reverseAlarmSort">
                                                            Alarm Number <span ng-show="orderByAlarmField == 'alarmNumber'"><span ng-show="!reverseAlarmSort">^</span><span ng-show="reverseAlarmSort">v</span></span>
                                                        </a>
                                                    </th>
                                                    <th id=alarmToolIdHeader>
                                                        <a href="" ng-click="orderByAlarmField=sorterFunc; reverseAlarmSort = !reverseAlarmSort">
                                                            Tool ID <span ng-show="orderByAlarmField == sorterFunc"><span ng-show="!reverseAlarmSort">^</span><span ng-show="reverseAlarmSort">v</span></span>
                                                        </a>
                                                    </th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr ng-repeat="alarmDetails in alarmsCategory | filter:searchAlarms | orderBy:orderByAlarmField:reverseAlarmSort" ng-click="showAlarmsToolMap($event,alarmDetails.assetId)"
                                                    style="cursor: pointer">
                                                    <td>{{alarmDetails.timestamp | date:'HH:mm:ss'}}</td>
                                                    <td>{{alarmDetails.message}}</td>
                                                    <td>{{alarmDetails.alarmNumber}}</td>
                                                    <td><a href=""  style="text-decoration: underline"  ng-click="showToolsList(alarmDetails.assetId)">{{alarmDetails.assetId}}</a></td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!--<div style="margin-left: 35%" id="paginationDiv">-->
                                            <!--<button ng-disabled="currentPage == 1" ng-click="currentPage=currentPage-1" type="button" class="btn btn-primary" id="previousButton">-->
                                                <!--Previous-->
                                            <!--</button> {{currentPage}}/{{numberOfPages}}-->
                                            <!--<button ng-disabled="currentPage >= tools.length/pageSize" ng-click="currentPage=currentPage+1" type="button" class="btn btn-primary" style="width: 81px;" id="nextButtton">-->
                                                <!--Next-->
                                            <!--</button>-->
                                        <!--</div>-->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class='col-lg-7 col-md-6 col-sm-12'>
            <div class='row'>
                <div class='col-xs-12'>
                    <div class='panel panel-default'>
                        <div class='panel-body'>
                            <div id="toolMap">
                                <img  rel="prefetch" alt="Image is not found" ng-src="{{siteImage}}" id="plantMap" style="width: 100%;height: 100%; z-index: -1" onerror="this.src='/img/ToolImageNotAvailable.png'">
                                <div>
                                    <div id="plantDiv" ng-repeat="tool in tools" ng-init='xcoordinate=getTransformedXValues(tool); ycoordinate=getTransformedYValues(tool); xSize = getToolLabelSize(tool)'>
                                        <span id="tool{{tool.assetId}}" class="toolLabel" ng-style="{'position': 'absolute',
                                      'left': xValue + xcoordinate, 'top': (yValue - ycoordinate - 17) + 'px'}" ng-bind="tool.assetId"></span>
                                        <span  class="glyphicon glyphicon-oil" id="{{tool.assetId}}" ng-click="toolDisplay(tool)" ng-dblclick="toolInfo($event)" ng-mouseover="showToolTitleMap($event, tool)"
                                               ng-style="{'cursor': 'pointer','position': 'absolute', 'text-shadow' :'-2px 0 black, 0 2px black, 2px 0 black, 0 -2px black',
                                              'left': xValue + xcoordinate, 'top': yValue - ycoordinate, 'z-index': '2'}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class='row tool-availability-container'>
                <div class='col-xs-12'>
                    <div class='panel panel-default availability-panel'>
                        <div class='panel-heading'><b id="toolAvailHeaderId">Tool Availability</b>
                        <div class="pull-right">
                            <!--<span class="glyphicon glyphicon-refresh"id="refreshHistory" style="cursor:pointer"></span>-->
                        </div>
                        </div>
                        <div class='panel-body'>
                            <div id="toolAvailability"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>